module Constants
( programCounterIncrement,
  chip8NumberOfColumns,
  chip8InitialState,
  chip8Fontset
) where

import System.Random
import qualified Data.Vector as V
import Data.Word

import Types

programCounterIncrement :: Word16
programCounterIncrement = 0x0002

chip8NumberOfColumns :: Int
chip8NumberOfColumns = 64

chip8InitialState :: Chip8State
chip8InitialState = Chip8State {
  _currentOpcode = 0x0000,
  _memory = V.replicate 4096 0x00,
  _vRegisters = V.replicate 16 0x00,
  _indexRegister = 0x0000,
  _programCounter = 0x200,
  _graphics = V.replicate 2048 0x00,
  _delayTimer = 0x00,
  _soundTimer = 0x00,
  _stack = V.replicate 16 0x00,
  _stackPointer = 0x0000,
  _keyState = V.replicate 16 Unpressed,
  _drawFlag = False,
  _randomNumberSeed = mkStdGen 0
}

chip8Fontset :: [Word8] 
chip8Fontset =  
  [ 0xF0, 0x90, 0x90, 0x90, 0xF0
  , 0x20, 0x60, 0x20, 0x20, 0x70
  , 0xF0, 0x10, 0xF0, 0x80, 0xF0 
  , 0xF0, 0x10, 0xF0, 0x10, 0xF0
  , 0x90, 0x90, 0xF0, 0x10, 0x10
  , 0xF0, 0x80, 0xF0, 0x10, 0xF0
  , 0xF0, 0x80, 0xF0, 0x90, 0xF0
  , 0xF0, 0x10, 0x20, 0x40, 0x40
  , 0xF0, 0x90, 0xF0, 0x90, 0xF0
  , 0xF0, 0x90, 0xF0, 0x10, 0xF0
  , 0xF0, 0x90, 0xF0, 0x90, 0x90
  , 0xE0, 0x90, 0xE0, 0x90, 0xE0
  , 0xF0, 0x80, 0x80, 0x80, 0xF0
  , 0xE0, 0x90, 0x90, 0x90, 0xE0 
  , 0xF0, 0x80, 0xF0, 0x80, 0xF0
  , 0xF0, 0x80, 0xF0, 0x80, 0x80 ]